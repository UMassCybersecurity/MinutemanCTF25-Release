import hashlib


def identity_permutation(size):
    """
    Returns a list of the form [0,1,2,...,size-1]
    """
    return list(range(size))


def apply_permutation(perm, target):
    """
    This code uses a permutation to shuffle the target array. For example:
    apply_permutation([0,3,1,2], ['a', 'b', 'c', 'd']) == ['a', 'd', 'b', 'c']
    apply_permutation([3,2,1,0], [1,2,3,0]) == [0, 3, 2, 1]
    """
    result = identity_permutation(len(perm))
    for i, j in enumerate(perm):
        result[i] = target[j]
    return result


def binary_exponentiate(perm, power):
    """
    This code does the same as the following (but much more efficiently):
    result = identity_permutation(len(perm))
    for _ in range(power):
        result = apply_permutation(perm, result)
    return result
    """
    result = identity_permutation(len(perm))
    perm_to_the_2_i = perm
    while power > 0:
        if power % 2 == 1:
            result = apply_permutation(perm_to_the_2_i, result)
        perm_to_the_2_i = apply_permutation(perm_to_the_2_i, perm_to_the_2_i)
        power >>= 1
    return result


g = [564, 420, 522, 432, 219, 923, 200, 891, 869, 440, 372, 845, 523, 121, 91, 206, 413, 925, 397, 5, 942, 134, 605, 355, 127, 749, 754, 691, 340, 836, 881, 174, 23, 154, 893, 699, 144, 423, 394, 350, 123, 41, 702, 143, 100, 196, 250, 433, 815, 294, 426, 908, 985, 42, 258, 55, 650, 947, 34, 654, 907, 899, 316, 625, 578, 313, 312, 600, 348, 919, 748, 427, 328, 318, 976, 872, 210, 217, 3, 285, 476, 70, 857, 975, 518, 986, 759, 579, 525, 772, 186, 974, 672, 617, 88, 993, 465, 591, 49, 213, 129, 561, 341, 941, 774, 751, 695, 67, 596, 955, 767, 828, 365, 816, 954, 31, 390, 246, 277, 13, 248, 833, 439, 530, 513, 860, 593, 995, 50, 871, 327, 319, 422, 705, 387, 33, 401, 768, 626, 334, 788, 458, 495, 61, 267, 220, 964, 598, 179, 404, 443, 180, 28, 453, 352, 65, 679, 342, 970, 590, 791, 853, 76, 444, 324, 307, 633, 19, 782, 188, 177, 534, 720, 983, 407, 323, 544, 480, 195, 573, 283, 557, 637, 752, 686, 167, 241, 725, 777, 275, 546, 649, 315, 566, 268, 278, 529, 973, 761, 620, 259, 106, 44, 621, 273, 644, 806, 655, 666, 965, 628, 190, 755, 12, 585, 141, 844, 212, 903, 586, 398, 130, 516, 231, 545, 886, 6, 875, 377, 924, 309, 410, 403, 569, 189, 78, 96, 521, 864, 221, 484, 133, 946, 330, 156, 150, 62, 145, 547, 514, 554, 794, 812, 230, 959, 599, 826, 493, 289, 223, 441, 863, 117, 988, 966, 883, 18, 509, 577, 770, 59, 392, 343, 552, 226, 442, 497, 614, 136, 603, 83, 448, 119, 153, 388, 85, 234, 963, 740, 411, 139, 580, 197, 149, 368, 698, 583, 386, 841, 97, 994, 424, 991, 838, 958, 724, 160, 74, 472, 909, 504, 615, 739, 969, 402, 997, 843, 674, 588, 192, 428, 582, 276, 114, 559, 712, 539, 52, 173, 956, 438, 37, 867, 629, 280, 436, 939, 571, 218, 900, 115, 898, 454, 64, 40, 753, 616, 470, 356, 113, 673, 233, 29, 540, 897, 333, 45, 477, 868, 346, 818, 138, 90, 796, 784, 727, 541, 842, 978, 293, 474, 715, 979, 201, 913, 240, 980, 79, 687, 701, 556, 510, 984, 861, 335, 706, 665, 707, 802, 866, 549, 524, 880, 819, 266, 102, 511, 80, 451, 409, 646, 361, 548, 358, 99, 998, 216, 837, 684, 182, 829, 914, 660, 299, 183, 364, 252, 835, 639, 613, 71, 418, 322, 491, 164, 391, 553, 256, 471, 60, 921, 297, 888, 917, 344, 520, 375, 792, 449, 30, 500, 108, 109, 84, 112, 938, 648, 357, 783, 135, 291, 122, 565, 482, 414, 528, 850, 452, 155, 550, 87, 282, 717, 652, 314, 950, 764, 771, 658, 359, 882, 642, 227, 461, 778, 915, 300, 290, 745, 456, 638, 807, 412, 381, 656, 301, 918, 235, 962, 447, 445, 159, 257, 249, 202, 468, 116, 859, 526, 68, 736, 779, 163, 670, 94, 466, 636, 718, 671, 789, 890, 982, 120, 374, 264, 237, 419, 36, 199, 822, 224, 305, 575, 165, 659, 187, 107, 895, 730, 555, 839, 542, 184, 711, 572, 515, 385, 337, 20, 929, 46, 680, 298, 936, 161, 847, 747, 193, 576, 967, 499, 581, 592, 957, 95, 239, 928, 676, 21, 147, 910, 611, 854, 9, 370, 889, 927, 349, 563, 205, 72, 719, 823, 172, 92, 733, 105, 501, 151, 464, 270, 803, 756, 726, 331, 610, 473, 981, 951, 169, 325, 560, 647, 198, 852, 494, 415, 697, 758, 517, 10, 43, 430, 437, 332, 222, 531, 481, 171, 251, 487, 272, 425, 396, 723, 961, 831, 469, 269, 685, 15, 669, 22, 668, 389, 247, 765, 203, 527, 661, 989, 24, 296, 944, 896, 142, 1000, 930, 336, 369, 479, 885, 39, 263, 677, 110, 417, 624, 855, 681, 302, 58, 383, 532, 809, 505, 489, 851, 310, 870, 651, 53, 543, 373, 931, 694, 703, 949, 584, 66, 810, 742, 960, 326, 238, 911, 148, 137, 455, 787, 496, 351, 634, 519, 709, 678, 635, 8, 32, 693, 281, 728, 421, 865, 204, 253, 27, 162, 399, 181, 507, 254, 902, 953, 623, 587, 295, 175, 795, 721, 846, 606, 690, 321, 429, 933, 406, 208, 664, 894, 104, 607, 567, 696, 128, 776, 486, 786, 537, 657, 732, 722, 0, 303, 14, 274, 533, 916, 354, 462, 125, 446, 769, 400, 490, 152, 945, 746, 641, 766, 840, 329, 1, 877, 262, 834, 261, 750, 11, 380, 990, 801, 595, 663, 800, 63, 467, 191, 653, 279, 450, 362, 211, 215, 594, 817, 460, 905, 131, 320, 608, 601, 862, 77, 612, 735, 688, 157, 987, 848, 288, 952, 485, 366, 793, 597, 878, 244, 799, 311, 713, 790, 506, 662, 920, 508, 93, 38, 140, 689, 57, 922, 804, 832, 243, 292, 338, 912, 56, 631, 185, 972, 111, 830, 827, 551, 813, 971, 475, 16, 498, 271, 260, 286, 760, 700, 124, 824, 478, 98, 89, 435, 892, 101, 535, 48, 940, 999, 416, 934, 512, 622, 948, 126, 382, 81, 937, 306, 773, 884, 716, 209, 731, 811, 589, 744, 284, 304, 943, 743, 376, 345, 86, 876, 207, 73, 265, 714, 568, 887, 814, 757, 874, 25, 682, 632, 168, 434, 798, 729, 667, 502, 856, 503, 384, 228, 82, 371, 932, 741, 225, 805, 146, 178, 47, 627, 734, 977, 242, 488, 619, 873, 849, 229, 906, 797, 170, 492, 926, 645, 996, 17, 821, 858, 236, 255, 785, 287, 176, 604, 2, 367, 640, 483, 992, 166, 558, 904, 738, 935, 602, 762, 683, 675, 968, 562, 393, 232, 704, 158, 781, 630, 379, 431, 132, 820, 194, 457, 26, 618, 879, 609, 405, 75, 118, 808, 395, 353, 780, 378, 347, 708, 901, 536, 214, 408, 710, 54, 308, 4, 103, 570, 643, 51, 339, 360, 463, 459, 35, 737, 69, 825, 317, 574, 245, 775, 363, 692, 763, 7, 538]
ga = [255, 868, 818, 739, 877, 78, 639, 894, 366, 42, 871, 459, 9, 258, 188, 781, 12, 520, 352, 235, 151, 874, 19, 477, 525, 767, 988, 266, 662, 785, 178, 558, 357, 486, 590, 378, 7, 47, 135, 22, 915, 41, 975, 97, 946, 689, 802, 960, 499, 787, 121, 495, 354, 83, 992, 55, 933, 448, 159, 758, 912, 560, 676, 731, 594, 961, 428, 100, 59, 850, 730, 675, 184, 420, 533, 480, 276, 102, 312, 82, 836, 528, 805, 831, 236, 306, 336, 844, 740, 361, 569, 777, 942, 143, 288, 1000, 410, 307, 679, 568, 393, 573, 294, 328, 507, 128, 763, 44, 766, 974, 248, 482, 240, 747, 800, 936, 647, 181, 607, 54, 588, 289, 218, 797, 274, 67, 171, 187, 13, 819, 938, 267, 321, 677, 207, 726, 900, 380, 168, 359, 269, 799, 126, 591, 891, 349, 709, 140, 400, 796, 229, 948, 803, 668, 918, 615, 893, 810, 303, 492, 742, 780, 322, 436, 209, 500, 425, 487, 750, 329, 441, 980, 835, 635, 21, 466, 944, 108, 382, 646, 704, 8, 52, 403, 544, 610, 205, 860, 956, 734, 765, 193, 789, 989, 957, 984, 693, 356, 572, 465, 369, 998, 242, 501, 26, 872, 601, 340, 673, 254, 497, 626, 898, 563, 627, 798, 979, 341, 562, 714, 113, 445, 923, 149, 537, 881, 418, 752, 634, 259, 201, 404, 77, 963, 906, 66, 231, 473, 576, 490, 199, 644, 658, 885, 34, 913, 557, 567, 951, 123, 506, 386, 727, 373, 792, 545, 873, 344, 317, 293, 25, 795, 699, 313, 839, 645, 154, 502, 457, 424, 598, 81, 104, 754, 421, 14, 261, 481, 339, 285, 616, 264, 977, 623, 101, 857, 914, 170, 526, 674, 469, 559, 348, 363, 157, 239, 474, 332, 696, 165, 513, 383, 381, 991, 643, 282, 671, 736, 414, 106, 801, 703, 471, 609, 237, 848, 148, 402, 71, 509, 729, 827, 756, 764, 965, 493, 516, 738, 686, 426, 632, 904, 511, 139, 346, 443, 364, 476, 945, 439, 543, 368, 57, 774, 475, 24, 446, 478, 654, 546, 605, 287, 926, 284, 295, 290, 809, 93, 212, 741, 371, 886, 233, 355, 362, 484, 204, 554, 342, 996, 517, 399, 345, 405, 6, 518, 570, 896, 794, 603, 935, 930, 451, 379, 150, 529, 867, 655, 561, 316, 624, 133, 70, 504, 33, 49, 141, 29, 816, 130, 496, 225, 521, 217, 878, 309, 372, 134, 392, 327, 99, 238, 37, 523, 232, 771, 365, 390, 804, 773, 943, 812, 582, 433, 861, 241, 833, 911, 657, 817, 841, 604, 462, 879, 828, 691, 84, 986, 296, 903, 702, 749, 91, 924, 375, 536, 685, 806, 966, 583, 324, 338, 275, 584, 947, 430, 875, 189, 311, 291, 216, 907, 39, 791, 515, 829, 174, 681, 198, 899, 745, 851, 183, 60, 36, 660, 124, 617, 551, 227, 596, 438, 331, 637, 620, 652, 319, 669, 253, 206, 973, 917, 434, 40, 908, 593, 592, 863, 494, 270, 902, 565, 335, 712, 790, 31, 272, 353, 895, 163, 2, 458, 318, 226, 530, 586, 858, 999, 96, 153, 728, 461, 56, 440, 705, 125, 202, 884, 921, 865, 244, 614, 176, 964, 103, 219, 196, 80, 578, 419, 388, 273, 723, 347, 968, 337, 63, 630, 305, 389, 580, 667, 262, 286, 636, 744, 166, 869, 882, 808, 976, 172, 220, 53, 599, 442, 737, 190, 661, 75, 532, 300, 941, 417, 20, 650, 724, 452, 852, 535, 147, 949, 971, 778, 937, 203, 429, 768, 427, 751, 257, 74, 117, 534, 664, 51, 467, 132, 788, 847, 129, 299, 298, 85, 396, 5, 277, 330, 376, 297, 621, 720, 186, 215, 807, 953, 648, 61, 301, 846, 950, 779, 167, 892, 62, 722, 782, 577, 859, 334, 826, 88, 370, 391, 972, 853, 343, 985, 415, 920, 472, 0, 622, 65, 86, 120, 116, 246, 678, 566, 483, 491, 952, 928, 11, 115, 15, 820, 761, 587, 423, 280, 970, 962, 46, 304, 326, 575, 856, 320, 690, 228, 683, 222, 548, 760, 743, 759, 602, 503, 552, 927, 821, 283, 880, 940, 161, 793, 447, 48, 514, 18, 252, 815, 958, 663, 394, 422, 221, 687, 967, 437, 408, 539, 842, 137, 555, 505, 114, 814, 606, 118, 249, 824, 775, 409, 10, 350, 540, 994, 700, 243, 211, 38, 119, 716, 131, 656, 397, 955, 17, 772, 925, 302, 169, 692, 146, 832, 706, 642, 107, 619, 377, 680, 197, 581, 247, 625, 732, 191, 136, 50, 358, 127, 35, 932, 708, 278, 987, 939, 479, 823, 983, 488, 407, 862, 649, 547, 556, 79, 164, 351, 138, 888, 718, 776, 406, 194, 144, 889, 870, 413, 840, 395, 90, 997, 489, 670, 770, 444, 498, 769, 463, 694, 665, 954, 333, 58, 208, 666, 837, 830, 611, 158, 688, 527, 43, 449, 618, 845, 281, 697, 786, 265, 641, 68, 746, 460, 715, 94, 585, 76, 453, 762, 707, 890, 876, 175, 412, 213, 595, 855, 883, 411, 640, 549, 735, 387, 825, 156, 401, 27, 95, 179, 4, 550, 531, 571, 112, 579, 73, 185, 931, 608, 398, 455, 574, 508, 432, 811, 600, 701, 89, 597, 105, 292, 843, 982, 755, 541, 981, 631, 638, 69, 28, 1, 919, 995, 629, 822, 748, 195, 152, 110, 922, 564, 757, 111, 717, 109, 522, 384, 993, 325, 245, 682, 901, 698, 978, 910, 30, 628, 684, 854, 672, 268, 589, 849, 468, 695, 710, 990, 87, 200, 864, 651, 260, 887, 192, 512, 32, 435, 162, 3, 223, 224, 315, 916, 633, 613, 360, 250, 308, 182, 464, 612, 470, 92, 385, 784, 542, 173, 180, 834, 524, 145, 310, 783, 367, 733, 16, 256, 279, 929, 713, 214, 553, 234, 263, 485, 519, 431, 230, 177, 721, 959, 98, 866, 659, 251, 838, 323, 210, 45, 905, 271, 711, 934, 454, 753, 72, 653, 155, 142, 122, 897, 160, 450, 969, 813, 456, 510, 314, 538, 374, 725, 23, 416, 909, 719, 64]
gb = [97, 462, 295, 596, 123, 177, 632, 606, 534, 416, 434, 424, 997, 978, 71, 80, 785, 523, 975, 170, 912, 551, 287, 7, 660, 867, 686, 53, 575, 392, 782, 838, 999, 616, 956, 853, 710, 724, 334, 351, 906, 41, 365, 513, 519, 987, 345, 119, 324, 214, 932, 151, 196, 112, 342, 55, 221, 779, 329, 618, 679, 913, 658, 562, 776, 944, 749, 879, 808, 419, 781, 208, 272, 888, 639, 8, 827, 657, 108, 76, 684, 950, 276, 240, 394, 628, 743, 712, 37, 349, 117, 427, 907, 994, 331, 714, 154, 226, 974, 192, 822, 94, 820, 636, 860, 212, 962, 960, 694, 951, 511, 674, 435, 439, 558, 303, 494, 495, 23, 368, 141, 308, 886, 734, 814, 433, 931, 651, 898, 111, 356, 685, 134, 316, 581, 346, 211, 179, 747, 335, 463, 935, 852, 374, 846, 984, 688, 792, 801, 131, 807, 87, 522, 314, 831, 633, 777, 203, 933, 426, 884, 718, 824, 298, 279, 421, 390, 916, 625, 943, 794, 250, 740, 64, 478, 543, 700, 793, 840, 790, 579, 593, 536, 312, 104, 737, 246, 491, 675, 73, 338, 643, 455, 65, 990, 89, 459, 598, 842, 18, 296, 488, 683, 265, 328, 557, 476, 949, 90, 285, 971, 816, 622, 315, 826, 939, 493, 851, 757, 530, 339, 348, 75, 726, 500, 765, 885, 3, 697, 449, 763, 486, 428, 699, 875, 441, 33, 966, 403, 68, 691, 62, 283, 93, 188, 481, 468, 382, 458, 189, 753, 870, 925, 998, 857, 307, 703, 286, 454, 583, 386, 466, 142, 544, 442, 604, 83, 940, 69, 791, 959, 620, 187, 173, 641, 318, 175, 355, 772, 972, 375, 565, 294, 464, 819, 210, 227, 378, 904, 414, 384, 701, 147, 778, 585, 815, 899, 587, 568, 274, 721, 742, 327, 182, 532, 102, 859, 418, 235, 663, 668, 425, 766, 968, 448, 528, 310, 947, 798, 678, 767, 207, 707, 936, 603, 957, 205, 45, 343, 834, 617, 305, 768, 502, 436, 723, 680, 146, 881, 138, 733, 185, 621, 725, 914, 475, 84, 381, 140, 122, 233, 35, 271, 129, 693, 891, 788, 719, 642, 443, 555, 546, 262, 144, 552, 520, 103, 4, 610, 474, 560, 744, 344, 909, 330, 27, 802, 162, 608, 896, 646, 738, 401, 377, 614, 845, 981, 803, 631, 946, 202, 389, 15, 453, 280, 955, 380, 408, 900, 197, 830, 190, 783, 471, 319, 695, 257, 745, 656, 973, 918, 183, 576, 735, 66, 273, 17, 526, 564, 86, 717, 0, 387, 128, 769, 624, 640, 666, 191, 156, 213, 705, 415, 13, 411, 9, 696, 805, 469, 168, 252, 665, 588, 38, 841, 654, 236, 571, 889, 359, 379, 225, 512, 402, 669, 829, 858, 850, 166, 861, 325, 49, 771, 895, 281, 352, 347, 26, 704, 150, 510, 649, 78, 98, 910, 864, 709, 894, 930, 923, 366, 290, 548, 938, 728, 671, 648, 260, 201, 337, 59, 50, 833, 234, 942, 948, 595, 323, 92, 965, 812, 645, 542, 268, 584, 970, 127, 600, 863, 602, 354, 556, 215, 243, 275, 264, 872, 976, 266, 992, 440, 395, 698, 692, 866, 423, 672, 795, 16, 550, 14, 796, 720, 920, 554, 514, 11, 902, 817, 644, 871, 941, 878, 302, 507, 736, 218, 155, 77, 44, 209, 360, 983, 479, 877, 499, 417, 198, 825, 437, 200, 88, 278, 848, 591, 120, 313, 451, 789, 181, 611, 964, 95, 288, 60, 399, 217, 919, 460, 690, 254, 818, 655, 741, 521, 813, 839, 101, 799, 868, 553, 6, 51, 367, 406, 20, 204, 407, 485, 74, 887, 124, 99, 901, 137, 963, 363, 477, 46, 659, 832, 525, 647, 759, 333, 391, 518, 245, 160, 223, 397, 883, 927, 515, 242, 854, 746, 876, 708, 163, 615, 412, 61, 549, 422, 594, 995, 385, 541, 370, 5, 43, 681, 176, 676, 396, 498, 908, 96, 263, 130, 751, 228, 172, 269, 158, 537, 193, 623, 284, 105, 444, 650, 309, 372, 570, 186, 371, 237, 25, 577, 811, 977, 569, 232, 673, 761, 148, 410, 905, 762, 988, 132, 934, 489, 231, 774, 171, 847, 450, 452, 42, 732, 291, 72, 405, 661, 837, 292, 126, 67, 82, 727, 241, 535, 843, 48, 662, 31, 447, 293, 996, 457, 874, 244, 490, 492, 362, 10, 118, 125, 357, 398, 629, 341, 159, 446, 224, 702, 547, 413, 220, 299, 409, 420, 748, 804, 609, 689, 467, 47, 924, 922, 823, 270, 2, 178, 903, 601, 304, 722, 755, 739, 915, 635, 22, 505, 731, 301, 400, 222, 892, 538, 230, 470, 945, 958, 982, 573, 821, 952, 754, 113, 336, 716, 34, 590, 911, 619, 110, 540, 836, 247, 729, 592, 70, 545, 627, 652, 430, 937, 682, 508, 980, 376, 174, 267, 169, 784, 612, 882, 856, 24, 56, 599, 261, 300, 139, 986, 770, 501, 800, 255, 431, 806, 559, 30, 893, 239, 482, 989, 321, 317, 993, 28, 985, 953, 340, 238, 926, 574, 199, 297, 472, 605, 107, 880, 152, 637, 91, 567, 563, 219, 504, 249, 164, 149, 533, 921, 670, 773, 566, 216, 664, 136, 465, 473, 497, 638, 114, 917, 79, 145, 764, 358, 580, 393, 653, 39, 572, 388, 828, 869, 539, 667, 432, 929, 797, 509, 258, 206, 862, 890, 332, 954, 143, 63, 289, 364, 248, 897, 531, 586, 194, 277, 597, 322, 865, 167, 229, 626, 756, 786, 750, 282, 873, 1, 787, 180, 373, 259, 326, 503, 438, 752, 589, 251, 121, 855, 613, 517, 12, 713, 480, 135, 165, 81, 969, 835, 677, 706, 979, 19, 445, 810, 116, 991, 461, 809, 496, 404, 1000, 849, 350, 967, 195, 153, 320, 844, 715, 29, 311, 634, 133, 21, 630, 760, 456, 184, 306, 54, 524, 106, 687, 32, 85, 109, 100, 353, 780, 483, 115, 582, 758, 256, 484, 369, 157, 487, 40, 506, 561, 928, 578, 361, 529, 527, 383, 161, 961, 516, 52, 57, 429, 607, 58, 36, 730, 253, 711, 775]
ciphertext = bytes.fromhex("71168a597d31dbd52e91171f7128f18038bdc6928c3b338e7e72b1d2a572ae757f1eb5de791ff9a62d01")


def perm_to_cycles(permutation):
    cycles = []
    for i in range(len(permutation)):
        cycle = ()
        while permutation[i] != -1:
            cycle += (i,)
            permutation[i], i = -1, permutation[i]
        if cycle:
            cycles.append(cycle)
    return cycles

def cycle_to_perm(cycle, length):
    permutation = identity_permutation(length)
    last = cycle[0]
    for current in cycle[1:]:
        permutation[last] = current
        last = current
    permutation[last] = cycle[0]
    return permutation

cycles = perm_to_cycles(g)
shared_private_key = identity_permutation(len(g))
for cycle in cycles:
    a = cycle.index(ga[cycle[0]])
    b = cycle.index(gb[cycle[0]])
    c = cycle_to_perm(cycle, len(g))
    c = binary_exponentiate(c, a * b)
    shared_private_key = apply_permutation(c, shared_private_key)

one_time_pad = hashlib.sha512(str(shared_private_key).encode()).digest()
def xor(key, msg):
    result = []
    for k, m in zip(key, msg):
        result.append(k ^ m)
    return bytes(result)

print(f'{xor(one_time_pad, ciphertext).decode()}')
